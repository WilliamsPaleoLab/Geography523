---
title: "Peyton_CA"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##2). Apply CA to arctic pollen data

Let's run CCA on the arctic pollen data.
```{r, echo = FALSE}
library(vegan)
library(palaeoSig)
```

```{r}
a.pollen <- sqrt(arctic.pollen) #Load pollen data, sqrt transform
pollen.ca <- cca(a.pollen)
plot(pollen.ca, display = "sites", scaling = 2, main = "Arctic Pollen")
pollen.ca
```

The arch effect is very noticable in this visualization. Let's add an ordination surface for July temperature.

```{r}
arctic.temp <- arctic.env
july.temp <- arctic.temp$tjul
plot(ordisurf(pollen.ca, july.temp), xlab = "CA1", ylab = "CA2")
```


##Apply redundancy analysis to a pollen record from Southern Norway


First we load RDA_Data. Then:
```{r}
RDA_Dat <- readRDS("RDA_Data.RDS")
RDA <- RDA_Data
RDA[,1:25] <- sqrt(RDA[,1:25]) #Sqrt transform pollen data
RDA_form <- RDA[,1:25]
RDA_data <- RDA[,26:27]
RDA_temp <- rda(RDA_form, RDA_data$temp.rec) #July temp constrained
layout(matrix(c(1,2,3,4,5,6), byrow = FALSE, ncol = 3))
plot(RDA_temp, main = "Temp constrained") #Plot full
plot(RDA_temp, display = "sites", main = "Temp Constrained") #Just sites displayed
RDA_precip <- rda(RDA_form, RDA_data$precip.rec) #Mean annual precip constrained
plot(RDA_precip, main = "Precip constrained") #Plot full
plot(RDA_precip, display = "sites", main = "Precip constrained") #Just sites displayed
RDA_rda <- rda(RDA_form, RDA_data) #Jointly constrained
plot(RDA_rda, main = "Jointly constrained") #Plot full
plot(RDA_rda, display = "sites", main = "Jointly constrained") #Just sites
````


```{r}
RDA_rda #Look at variance explained by axes
head(summary(RDA_rda))
```


Variance explained by constrained axes (RDA1 & RDA2) = 0.4862. Proportion explained by RDA1 = 0.3235, RDA2 = 0.1627.
 Variance explained by unconstrained axes (PC1, PC2, ..., PC25) = 0.5138. Proportion explain by PC1 = 0.2017, PC2 = 0.05923. Continues to decrease in proportion as we go to higher PCA axes (as expected).


#####Make a tri-plot with ordination surface for July temperature and mean annual precipitation
```{r}
RDA_rda
plot(RDA_rda) #Plot RDA with all components
layout(matrix(c(1,2,5,3,4,6), byrow = TRUE, ncol = 3))
plot(ordisurf(RDA_rda, RDA_data$temp.rec), main = "July Temp") #Plot with ordination surface of July temperatures
plot(ordisurf(RDA_rda, RDA_data$precip.rec), main = "Mean Annual Precip") #Plot with ordination surface of mean annual precipitation
plot(ordisurf(RDA_rda, RDA_data$precip.rec, RDA_data$temp.rec), main = "Both") #Plot with both - Not sure why sites are arranged differently in this plot. Likely due to the fact that the axes displayed are different - instead of RDA1 and RDA2 we have PC12 and PC10.
```


It appears July temperatures and mean annual precipitation values are somewhat orthogonal explanatory variables in this analysis. It appears that cold and dry tolerant species are found in the upper layers of this core (top left in ordination space), whereas toward the middle of the core we start to see colder and wetter conditions (and associated species like birch and alder) as we go further back in time. After a certain point we have a progressive increase in temperature and an increase in dryer conditions as we get into even deeper layers. This appears to be associated most heavily with Pine pollen.