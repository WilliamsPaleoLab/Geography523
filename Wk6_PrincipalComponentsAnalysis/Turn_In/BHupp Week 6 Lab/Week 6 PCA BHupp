Week 6: Ordinations: Principle Components Analysis
Brittany Hupp

ARCTIC DATASET IN VEGAN
#PCA using Arctic dataset preloaded in vegan
#Loaded vegan, palaeoSig, and the get_dataset
library(palaeoSig)
data("arctic.env")

#viewed dataset
> View(arctic.env)

#Used columns in datset to create subsets of data
> temp_feb <- arctic.env$tfeb
> temp_july <- arctic.env$tjul
> ann_meantemp <- arctic.env$tave
> precip_July <- arctic.env$pjul
> precip_Jan <- arctic.env$pjan
> precip_ann_sum <- arctic.env$ptotal

#Create a data.frame
arctic.pca <- data.frame(temp_feb,temp_july,ann_meantemp,precip_ann_sum,precip_Jan,precip_July)

#Run RDA
arctic.rda <- rda(arctic.pca)
plot(arctic.rda)

#Limits were added to the x-axis because of an extreme outlier
plot(arctic.rda,xlim=c(-20,10))

#"Summary" was used to determine variance of data frame RDA
summary(arctic.rda)
#There were the results:
Call:
rda(X = arctic.pca)

Partitioning of variance:
              Inertia Proportion
Total          119773          1
Unconstrained  119773          1

Eigenvalues, and their contribution to the variance

Importance of components:
                            PC1       PC2       PC3       PC4       PC5       PC6
Eigenvalue            1.195e+05 221.53436 3.418e+01 3.213e+01 6.257e+00 2.992e-01
Proportion Explained  9.975e-01   0.00185 2.854e-04 2.683e-04 5.224e-05 2.498e-06
Cumulative Proportion 9.975e-01   0.99939 9.997e-01 9.999e-01 1.000e+00 1.000e+00

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  99.76222


Species scores

                    PC1      PC2     PC3      PC4      PC5        PC6
temp_feb        -1.5448 -0.22529  0.3491 -1.23027 -0.34114  0.0637423
temp_july       -0.2003 -0.55399 -0.1516 -0.54846  0.60763  0.0615615
ann_meantemp    -1.0229 -0.48213  0.1573 -0.84419  0.12242 -0.1303004
precip_ann_sum -98.9436  0.07638  0.1822  0.05907  0.01746  0.0007100
precip_Jan      -9.0653  2.16739 -1.3866 -0.36988 -0.06059 -0.0057153
precip_July     -7.2495 -3.62143 -0.8455  0.05270 -0.12392  0.0005586

#Site scores were also included in the results of "summary"

#Screeplot was made
screeplot(arctic.rda)

#Screeplot with broken stick null model included was made
screeplot(arctic.rda,bstick = TRUE)

#Interpretation of the correlation matrix:
If you study the species scores, you'll find that the sum of annual precipitation
produces the highest corrlation with PC1, followed by January and July precipitation,
respectively. This suggests that precipitation is likely the controlling factor shown by PC1.

#Ordination plots made with and without the outlier using RDA
biplot(arctic.rda,
+        display = c("sites",
+                    "species"),
+        type = c("text",
+                 "points"),
+        xlim = c(-20,10))
The ordination plots further confirm annual sum of precipitation as being the
most important source/control on the variance.
#Ordination plots were made using princomp
> ?princomp
> arctic.princomp <- princomp(arctic.pca)
> biplot(arctic.princomp)
I wasn't able to get the more detailed code for more detailed ordination plots that
was included in the original assignment instructionsto work.

When checking out the ordination plot, it is clear to see what quadrants equate to
various climate/biome types, specifically with combinations of warm/cold and wet/dry.
It is not totally surprising that the artic data shows a clustering of data points
in the quadrant that represents a "cold and dry" climate, as that would be the ideal
environment for many arctic plants to flourish.
See Lab 6 Figures PDF

PCA USING POLLEN DATA FROM LAKE MENDOTA, D CORE

#Load appropriate packages
> library(neotoma)
> library(analogue)
> library(rioja)

#Acquiring dataset from neotoma with age constraints
> mendota_ds <- get_dataset(1679, ageold = 9000, ageyoung = 0)

#Download data, transform to percentages, and filter to include only taxa with
 abundance greater than 2%.
> mendota_data <- get_download(mendota_ds)
> mendota_pol <- mendota_data[[1]]
> mendota_pol_p25 <- compile_taxa(mendota_data[[1]], list.name="P25")
> mendota_pol_pct <- analogue::tran(x = mendota_pol$counts, method = 'percent')
> mendota_pol_pct_nr <- mendota_pol_pct[, colMeans(mendota_pol_pct, na.rm = TRUE) > 2]

#Took the square root and then did RDA; made an ordination plot and Screeplot
> mendota_sqrt <- sqrt(mendota_pol_pct_nr)
> mendota.rda <- rda(mendota_sqrt)
> biplot(mendota.rda)
> biplot(mendota.rda,
+        display = c("sites",
+                    "species"),
+        type = c("text",
+                 "points"),
+        ylim = c(-1,1))
> screeplot(mendota.rda,bstick = TRUE)

When comparing the ordination plot to the pollen diagram there do seem to be some similarities.
For example, in the ordination plot, it appears that whatever is controlling the variance in
Quercus explains much of the variance within the data. Conversely, we find that whatever is
controlling the abundance of Picea, Ulmus, and other taxa that are more abundant below 700 cm
also explains much of the variance within the data. Considering that Picea and Quercus seem to
dominate two distinct ecospaces, the ordination plot further supports that observation.
See Lab 6 Figures PDF
